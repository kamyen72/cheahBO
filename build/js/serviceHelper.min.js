function formatDate(t,e){if(t){var g=t.getHours(),a=t.getMinutes(),n=12<=g?"pm":"am",n=(g=(g%=12)||12)+":"+(a=a<10?"0"+a:a)+" "+n;return e?t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+"  "+n:t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()}}function getDateS(t){if(t)return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" 00:00:00"}function getDateE(t){if(t)return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" 23:59:59"}
var colors=["#5793f3","#d14a61","#675bba"],GHLcolors=["#4281A4","#48A9A6","#7180AC","#E84855","#0D1B2A"],genBarOption=function(e,t,a){var o=a.map(e=>({name:e.title,type:"bar",data:e.data,color:e.color,markPoint:{data:[{type:"max",name:"最大值"},{type:"min",name:"最小值"}]},markLine:{data:[{type:"average",name:"平均值"}]}}));return console.log(o),{title:{text:e,subtext:"",textStyle:{color:GHLcolors[0]}},tooltip:{trigger:"axis"},legend:{data:a.map(e=>e.title)},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",data:t}],yAxis:[{type:"value",axisLine:{lineStyle:{color:GHLcolors[4]}}}],series:o}},genLineBarOption=function(e,t,a){var o=a.map(e=>({name:e.title,type:e.type,data:e.data,color:e.color,yAxisIndex:e.yIndex}));return console.log(o),{title:{text:e,subtext:"",textStyle:{color:GHLcolors[0]}},tooltip:{trigger:"axis"},legend:{data:a.map(e=>e.title)},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",data:t}],yAxis:[{type:"value",name:"%",position:"right",min:0,max:100,axisLine:{lineStyle:{color:colors[0]}},axisLabel:{formatter:"{value} %"}},{type:"value",name:"Amount",position:"left",axisLine:{lineStyle:{color:GHLcolors[4]}},axisLabel:{formatter:"{value} $"}}],series:o}},genCashRebateOption=function(e,t,o){var a=o.map((e,t)=>{var a={};return(a={name:e.title,type:e.type,data:e.data,color:e.color}).label=0<t?{normal:{formatter:function(e){return(e.data/o[0].data[e.dataIndex]*100).toFixed(2)+"%"},position:"top",show:!0,value:1}}:{normal:{formatter:function(e){return e.data.toFixed(2)},position:"top",show:!0,value:1}},a});return console.log(a),{title:{text:e,subtext:"",textStyle:{color:GHLcolors[0]}},tooltip:{trigger:"axis"},legend:{data:o.map(e=>e.title)},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",data:t}],yAxis:[{type:"value",axisLine:{lineStyle:{color:GHLcolors[4]}}}],series:a}};
"use strict";app.factory("pageHelper",["$rootScope","ngAuthSettings",function(e,a){function g(e,a){var r=P;return 0<e?(e<=r.PageArray[r.PageArray.length-1]?r.CurrentPage=e:(r.CurrentPage=r.PageArray[r.PageArray.length-1],r.thisPage=r.PageArray[r.PageArray.length-1]),r.PageRangeMin=e,r.PageRangeMax=e+9):(r.CurrentPage=1,r.thisPage=1,r.PageRangeMin=1,r.PageRangeMax=10),r.CurrentPage||(r.CurrentPage=1),r.thisPage===r.CurrentPage&&r.thisPageSize===r.PageSize||(r.thisPageSize=r.PageSize,a.search()),r}var r={},t=[20,50,100],P={CurrentPage:1,PageSize:10,TotalItems:0,PageArray:[],PageRangeMax:10,PageRangeMin:1,thisPage:1};return r.getPagerObj=function(){return P},r.getPageSizeArray=function(){return t},r.setPageObj=function(e){(P=e).thisPage=e.CurrentPage,P.thisPageSize=e.PageSize,P.PageArray=[]},r.pageChanged=g,r.calculatorPageArray=function(){var e=P;if(0<e.TotalItems){var a=Math.ceil(e.TotalItems/e.PageSize);e.TotalPage=a,e.PageArray=[];for(var r=1;r<=a;r++)e.PageArray.push(r);e.CurrentPage>e.PageArray[e.PageArray.length-1]&&(e.CurrentPage=1,e.thisPage=1),g(e.CurrentPage)}return e},r}]);
function copy(e,n,t){if(n.createRange&&window.getSelection){range=n.createRange(),sel=window.getSelection(),sel.removeAllRanges();var a=n.getElementById(t);try{range.selectNodeContents(a),sel.addRange(range)}catch(e){range.selectNode(a),sel.addRange(range)}n.execCommand("Copy")}else e.createTextRange&&(range=e.createTextRange(),range.moveToElementText(a),range.select(),range.execCommand("Copy"))}function excel(e,n,t){for(var a,o,r="application/vnd.ms-excel",c="",l=0;l<n.length;l++)c+=e.getElementById(n[l]).outerHTML.replace(/ /g,"%20");a=e.createElement("a"),e.body.appendChild(a),navigator.msSaveOrOpenBlob?(o=new Blob(["\ufeff",c],{type:r}),navigator.msSaveOrOpenBlob(o,t)):(a.href="data:"+r+", "+c,a.download=t,a.click())}function print(e,n){e=e.getElementById(n),n=window.open("","","height=700,width=700");n.document.write(e.outerHTML),n.document.close(),n.print()}function sumFunction(t){return function(e,n){return n[t]?e+parseFloat(n[t]):e}}
function regular(){var self=this;self.isEmptyValue=function(e){return null==e||""==$.trim(e)},self.isEmail=function(e){return/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(e)},self.isPassword=function(e){var r;return(r=e?/^\w{6,12}$/:r).test(e)},self.isDouble=function(e){return new RegExp("^[0-9]+([.][0-9]+)?$").test(e)},self.isMobile=function(e){return new RegExp(/^(09([0-9]){8})$/).test(e)},self.isTel=function(e){return new RegExp(/^(([0-9]){2,3}\-[0-9]{5,8})$/).test(e)},self.isUrl=function(e){return!!e.match(/http:\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/)},self.isNumeric=function(e){return/^[0-9]{1,}$/.test(e)},self.checkTwID=function(id){var city=new Array(1,10,19,28,37,46,55,64,39,73,82,2,11,20,48,29,38,47,56,65,74,83,21,3,12,30);if(id=id.toUpperCase(),-1==id.search(/^[A-Z](1|2)\d{8}$/i))return!1;id=id.split("");for(var total=city[id[0].charCodeAt(0)-65],i=1;i<=8;i++)total+=eval(id[i])*(9-i);return total+=eval(id[9]),total%10==0}}function verifyModel(){var self=this;self.confirmBeforeSend=function(){var e=verification(self.verifyObjects);return!!e.success||(alert(e.message),!1)};var setForcusError=function(e){$(" [key="+e+"]").addClass("focusError")[0].focus();setTimeout(function(){$("*").removeClass("focusError")},3e3)},findPropertyName=function(obj){var properties=ko.mapping.toJS(self);try{$.each(properties,function(key,value){if(eval("self."+key)===obj)throw key})}catch(ex){return ex}return null},verification=function(objects){var regulars=new regular,findPropertyName=function(obj){var properties=ko.mapping.toJS(self);try{$.each(properties,function(key,value){if(eval("self."+key)===obj)throw key})}catch(ex){return ex}return null};if(null!=objects.required)try{$.each(objects.required,function(e,r){if(regulars.isEmptyValue(r()))throw setForcusError(findPropertyName(r)),{success:!1,message:"'"+self.chtNames[findPropertyName(r)]+"' 為必填項, 請再次確認!"}})}catch(ex){return ex}if(null!=objects.email)try{$.each(objects.email,function(e,r){if(!regulars.isEmail(r()))throw setForcusError(findPropertyName(r)),{success:!1,message:self.chtNames[findPropertyName(r)]+" 格式錯誤, 請再次確認!"}})}catch(ex){return ex}if(null!=objects.numeric)try{$.each(objects.numeric,function(e,r){if(!regulars.isNumeric(r()))throw setForcusError(findPropertyName(r)),{success:!1,message:"'"+self.chtNames[findPropertyName(r)]+"' 須為數字格式, 請再次確認!"}})}catch(ex){return ex}if(null!=objects.url)try{$.each(objects.url,function(e,r){if(!regulars.isUrl(r()))throw setForcusError(findPropertyName(r)),{success:!1,message:"'"+self.chtNames[findPropertyName(r)]+"' 須為網址格式, 請再次確認!\n\n(Ex: http://www.google.com.tw)"}})}catch(ex){return ex}if(null!=objects.passowrd)try{$.each(objects.passowrd,function(e,r){if(!regulars.isPassword(r()))throw setForcusError(findPropertyName(r)),{success:!1,message:"'"+self.chtNames[findPropertyName(r)]+"' 須為6-12碼字元, 請再次確認!"}})}catch(ex){return ex}return{success:!0,message:null}}}
function memberManageValidator(){var e=this,r={pass:!0,errStatus:[]};e.AddMember=function(e){let s=[];return r.pass=!0,null!=e.UserName&&""!=e.UserName||s.push({ErrIndex:"",ResMessage:s.length+1+". 帳號不可為空！ <br/>"}),null!=e.Birthday&&""!=e.Birthday||s.push({ErrIndex:"",ResMessage:s.length+1+". 生日不可為空！ <br/>"}),null!=e.Email&&""!=e.Email||s.push({ErrIndex:"",ResMessage:s.length+1+". Email不可為空！ <br/>"}),null!=e.Phone&&""!=e.Phone||s.push({ErrIndex:"",ResMessage:s.length+1+". 手機不可為空！ <br/>"}),0<s.length&&(r.errStatus=s,r.pass=!1),r},e.DelMember=function(e){let s=[];return r.pass=!0,null!=e&&""!=e||s.push({ErrIndex:"",ResMessage:s.length+1+". 您選擇要刪除的項目有問題，請與系統管理者Confirm！ <br/>"}),0<s.length&&(r.errStatus=s,r.pass=!1),r},e.FindNews=function(e,s,r,n,l,a,t){},e.UpdateMember=function(e){let s=[];return r.pass=!0,null!=e.UserName&&""!=e.UserName||s.push({ErrIndex:"",ResMessage:s.length+1+". 帳號不可為空！ <br/>"}),null!=e.Birthday&&""!=e.Birthday||s.push({ErrIndex:"",ResMessage:s.length+1+". 生日不可為空！ <br/>"}),null!=e.Email&&""!=e.Email||s.push({ErrIndex:"",ResMessage:s.length+1+". Email不可為空！ <br/>"}),null!=e.Phone&&""!=e.Phone||s.push({ErrIndex:"",ResMessage:s.length+1+". 手機不可為空！ <br/>"}),0<s.length&&(r.errStatus=s,r.pass=!1),r},e.ForgetPwd=function(e){let s=[];return r.pass=!0,null!=e.UserName&&""!=e.UserName||s.push({ErrIndex:"",ResMessage:s.length+1+". UserName不可為空！ <br/>"}),null!=e.Email&&""!=e.Email||s.push({ErrIndex:"",ResMessage:s.length+1+". Email不可為空！ <br/>"}),0<s.length&&(r.errStatus=s,r.pass=!1),r},e.Login=function(e){let s=[];return r.pass=!0,null!=e.UserName&&""!=e.UserName||s.push({ErrIndex:"",ResMessage:s.length+1+". UserName不可為空！ <br/>"}),null!=e.Pwd&&""!=e.Pwd||s.push({ErrIndex:"",ResMessage:s.length+1+". Pwd不可為空！ <br/>"}),0<s.length&&(r.errStatus=s,r.pass=!1),r}}